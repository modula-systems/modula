Search.setIndex({"docnames": ["algorithms/manifold/hypersphere", "algorithms/manifold/index", "algorithms/manifold/orthogonal", "bad-scaling", "examples/hello-mnist", "examples/hello-world", "examples/weight-erasure", "faq", "golden-rules", "history", "index", "intro/reading-list", "theory/atom/conv2d", "theory/atom/embed", "theory/atom/index", "theory/atom/linear", "theory/bond/index", "theory/bond/nonlinearities", "theory/compound/gpt", "theory/compound/index", "theory/module", "theory/vector"], "filenames": ["algorithms/manifold/hypersphere.rst", "algorithms/manifold/index.rst", "algorithms/manifold/orthogonal.rst", "bad-scaling.rst", "examples/hello-mnist.nblink", "examples/hello-world.nblink", "examples/weight-erasure.nblink", "faq.rst", "golden-rules.rst", "history.rst", "index.rst", "intro/reading-list.rst", "theory/atom/conv2d.rst", "theory/atom/embed.rst", "theory/atom/index.rst", "theory/atom/linear.rst", "theory/bond/index.rst", "theory/bond/nonlinearities.rst", "theory/compound/gpt.rst", "theory/compound/index.rst", "theory/module.rst", "theory/vector.rst"], "titles": ["Hypersphere", "Manifold duality maps", "Orthogonal manifold", "Bad scaling", "Hello, MNIST!", "Hello, World!", "Weight erasure", "Frequently asked questions", "Golden rules for scaling", "The science of scale", "Welcome to the Modula docs!", "Reading list", "Conv2d", "Embedding", "Atomic modules", "Linear", "Bond modules", "Nonlinearities", "GPT", "Compound modules", "Modules", "Vectors"], "terms": {"On": [0, 2, 3, 5, 7, 8, 9, 11], "thi": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "page": [0, 2, 5, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "we": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "work": [0, 1, 2, 3, 8, 9], "out": [0, 1, 2, 3, 7, 8, 9, 10], "an": [0, 2, 4, 5, 6, 7, 8, 9, 11], "algorithm": [0, 1, 2, 3, 7, 10, 11], "perform": [0, 2, 3, 7, 8], "under": [0, 1, 2, 3, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "euclidean": [0, 1, 7, 8], "norm": [0, 1, 2, 5, 6, 7, 8, 9, 11], "while": [0, 2, 3, 7, 8], "mai": [0, 3, 7, 8, 9], "seem": [0, 7, 8, 9], "obviou": [0, 7], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "good": [0, 3, 7, 8], "warmup": 0, "technic": [0, 7], "scaffold": 0, "help": [0, 1, 10], "more": [0, 2, 5, 7, 8, 9, 10], "complic": [0, 7], "exampl": [0, 2, 7, 8], "consid": [0, 1, 2, 6, 7, 8, 10], "weight": [0, 2, 3, 4, 5, 7, 8, 9, 11], "vector": [0, 1, 2, 4, 5, 7, 8, 9], "w": [0, 2, 4, 5, 6, 7, 9, 11], "mathbb": [0, 2, 6, 7], "r": [0, 2, 6, 7], "n": [0, 2, 6, 7], "unit": [0, 2, 5, 7, 8], "mean": [0, 2, 3, 6, 7, 8, 11], "squar": [0, 2, 5, 6, 7], "_2": [0, 7], "2": [0, 2, 4, 5, 6, 7, 8], "sum_": [0, 2], "1": [0, 2, 4, 5, 6, 7, 8, 9], "w_i": 0, "suppos": [0, 2, 3, 7], "gradient": [0, 2, 3, 5, 6, 7, 8, 9, 11], "g": [0, 2, 7], "deriv": [0, 1, 2, 5, 7, 9, 11], "some": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11], "loss": [0, 2, 3, 4, 5, 6, 7, 8, 11], "function": [0, 2, 3, 6, 7, 8], "evalu": [0, 2, 7], "given": [0, 1, 2, 6, 7], "step": [0, 1, 2, 4, 5, 6, 7, 8], "size": [0, 2, 4, 6, 7, 8, 9], "eta": [0, 2, 7, 11], "0": [0, 2, 4, 5, 6, 7, 8], "claim": [0, 2, 6, 7], "follow": [0, 1, 2, 3, 8, 9], "updat": [0, 2, 5, 6, 7, 8, 9, 11], "stai": [0, 2], "mapsto": [0, 2, 7], "frac": [0, 2, 6, 7, 8, 9], "sqrt": [0, 2, 6, 7, 8, 9], "time": [0, 2, 3, 5, 6, 7], "left": [0, 2, 3, 6, 7], "i_n": [0, 2], "top": [0, 2, 7, 8], "right": [0, 2, 3, 6, 7, 8], "so": [0, 1, 2, 3, 5, 6, 7, 8, 9], "simpli": [0, 2, 6, 9], "project": [0, 1, 2, 7], "subspac": [0, 7], "orthogon": [0, 1, 7, 8], "normal": [0, 3, 5, 7, 8, 9, 11], "obtain": [0, 2, 7, 9], "offload": 0, "problem": [0, 3, 4, 7, 8], "set": [0, 2, 6, 7, 8, 11], "choos": [0, 5, 7, 8, 11], "paramet": 0, "divid": [0, 2, 7, 8], "through": [0, 2, 7, 8, 9], "back": [0, 1, 2, 8, 9], "": [0, 1, 2, 3, 4, 6, 7, 8, 9, 10], "probabl": 0, "overkil": 0, "let": [0, 2, 3, 4, 6, 7, 8], "show": [0, 4, 6, 7, 8, 9], "formal": [0, 2, 7], "possibl": [0, 2, 7, 11], "veloc": [0, 2], "curv": [0, 1, 2, 6], "pass": [0, 2, 5], "For": [0, 2, 5, 6, 7, 8], "real": 0, "valu": [0, 2, 6, 7, 8], "t": [0, 2, 3, 4, 5, 6, 7, 8, 9], "If": [0, 2, 7, 9, 10], "differenti": [0, 2], "condit": [0, 7, 9, 11], "partial": [0, 2], "must": [0, 2, 7, 9], "convers": [0, 2, 8], "satisfi": [0, 2], "manifold": [0, 10], "can": [0, 1, 2, 3, 6, 7, 8, 9, 10, 11], "seen": [0, 8], "studi": [0, 7, 8, 9], "cdot": [0, 7], "co": 0, "sin": 0, "realli": [0, 7], "To": [0, 2, 6, 7, 8], "solv": [0, 1, 2, 3, 5, 9, 11], "operatornam": [0, 2, 6, 11], "arg": [0, 2, 11], "max": [0, 2, 6, 7], "_": [0, 2, 4, 5, 6, 7, 9, 11], "leq": [0, 2, 7, 11], "text": [0, 2, 6, 7, 9], "us": [0, 1, 2, 3, 5, 7, 8, 9, 10, 11], "method": [0, 5, 7], "lagrang": 0, "multipli": [0, 7, 8], "write": [0, 3, 4, 6, 7, 9], "down": [0, 8], "lagrangian": 0, "mathcal": [0, 7, 11], "l": [0, 6, 7, 8, 9, 11], "lambda": [0, 6, 8], "mu": 0, "take": [0, 1, 2, 5, 6, 7, 8, 9, 11], "respect": [0, 2, 3, 5, 7, 8, 11], "zero": [0, 2, 6, 8], "substitut": 0, "constraint": [0, 1, 2, 7, 11], "final": [0, 2, 4, 5, 6, 8], "make": [0, 2, 3, 5, 6, 7, 8, 9, 10], "along": [0, 3, 7], "calcul": [0, 4, 7], "previou": [0, 2, 6, 7, 8], "section": [0, 1, 2, 3, 6, 7, 8, 10], "leav": [0, 1, 2, 6], "In": [0, 1, 2, 3, 6, 7, 8, 9, 11], "fact": [0, 2, 6, 7, 8], "pythagora": 0, "theorem": [0, 7], "have": [0, 2, 3, 6, 7, 8, 9, 11], "scalar": [0, 2], "steepest": [1, 7], "descent": [1, 3, 6, 7, 8, 9, 11], "optim": [1, 2, 3, 6, 7, 9], "equip": [1, 2, 7], "certain": [1, 3, 7], "These": [1, 3, 7], "want": [1, 3, 7, 8, 10], "construct": [1, 2, 7, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "modul": [1, 5, 6, 7], "where": [1, 2, 3, 7, 8, 9, 11], "tensor": [1, 7, 8], "obei": 1, "natur": [1, 7, 8], "particular": [1, 2, 7, 9, 10], "hyperspher": 1, "matric": [1, 2, 6, 7, 8, 9], "spectral": [1, 2, 6, 7, 8, 9, 11], "each": [1, 2, 4, 6, 7, 8], "case": [1, 2, 3, 7, 8], "adopt": [1, 7], "strategi": 1, "character": [1, 2, 6], "tangent": 1, "space": [1, 7, 8, 11], "direct": [1, 7, 8, 9], "retract": 1, "which": [1, 2, 3, 6, 7, 8, 9, 11], "taken": [1, 7, 9], "think": [1, 6, 7, 8], "plane": 1, "ly": [1, 2], "point": [1, 2, 4, 6, 7, 8], "ha": [1, 2, 7, 8, 9], "its": [1, 2, 3, 4, 7, 8], "own": 1, "sinc": [1, 2, 7, 8], "discret": 1, "therefor": [1, 2, 7, 8], "need": [1, 2, 3, 6, 7, 8], "It": [1, 2, 3, 5, 7, 8, 9], "alwai": [1, 7, 8], "keep": [1, 8], "mind": [1, 8], "pictur": [1, 3], "ar": [2, 3, 5, 7, 8, 10, 11], "matrix": [2, 6, 7, 8, 9], "maxim": [2, 5, 7, 9], "linear": [2, 4, 5, 6, 7, 9, 11], "improv": [2, 3, 5, 10], "send": [2, 7], "from": [2, 3, 4, 5, 6, 7, 8, 9], "oftentim": 2, "simpl": [2, 3, 5, 7, 8], "multipl": [2, 4, 7], "first": [2, 3, 4, 6, 7, 8, 9, 10, 11], "comput": [2, 5, 7, 8], "x": [2, 4, 6, 7, 8], "sharp": 2, "begin": [2, 6], "full": [2, 7], "rank": [2, 7, 8], "otherwis": [2, 7], "end": [2, 6, 7, 9], "express": [2, 7, 8], "m": [2, 6, 7, 10, 11], "denot": [2, 7], "oper": [2, 3, 5, 6, 7, 8, 9], "appli": [2, 7, 8, 9], "return": [2, 4, 5, 6, 8], "same": [2, 6, 7, 8], "singular": [2, 6, 7, 8], "all": [2, 5, 6, 7, 8, 9], "posit": 2, "one": [2, 4, 6, 7, 8, 9], "run": 2, "newton": [2, 7], "schulz": 2, "iter": [2, 3, 7, 8], "cubic": 2, "m_0": 2, "_f": [2, 6], "qquad": [2, 9], "m_": 2, "3": [2, 4, 5, 6, 8], "m_t": 2, "m_tm_t": 2, "infti": [2, 7], "goe": [2, 7], "kovarik": 2, "1970": 2, "bj\u00f6rck": 2, "bowi": 2, "1971": 2, "One": [2, 7, 8], "reason": [2, 7], "interest": [2, 7, 9], "A": [2, 7, 8, 9, 11], "riemmanian": 2, "call": [2, 5, 7, 8, 9, 11], "metric": 2, "inner": [2, 7], "product": [2, 7], "defin": [2, 3, 6], "provid": [2, 7, 11], "wai": [2, 3, 6, 7, 8], "measur": [2, 5, 6, 7], "distanc": [2, 6, 9, 11], "geometri": [2, 7], "awar": [2, 6], "There": [2, 7, 11], "been": [2, 8, 9], "lot": [2, 7], "research": [2, 9, 10], "machin": [2, 7], "learn": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "context": 2, "fast": [2, 7], "accur": 2, "without": [2, 6, 7, 8, 9, 11], "effici": [2, 5, 7], "via": [2, 9, 11], "caylei": 2, "transform": [2, 3, 6, 7, 8], "howev": [2, 7], "seemingli": [2, 6, 7], "much": [2, 7, 8], "less": 2, "instanc": [2, 6, 7], "everi": [2, 8, 9], "doe": [2, 3, 6, 7, 8], "emerg": [2, 7], "But": [2, 6, 7, 8, 10], "believ": [2, 6, 7, 9], "kind": [2, 7, 8], "veri": [2, 6, 7, 8], "import": [2, 4, 5, 6, 7, 8, 9, 11], "deep": [2, 6, 7, 8, 9, 10, 11], "would": [2, 7, 9], "like": [2, 3, 7], "figur": [2, 4, 6], "roughli": [2, 8], "speak": 2, "particl": 2, "could": [2, 7], "parameter": [2, 7, 9], "evidenc": 2, "exp": 2, "tw": 2, "complet": [2, 6, 7], "chang": [2, 7, 8, 9], "variabl": [2, 8], "see": [2, 6, 7, 9], "belong": 2, "onli": [2, 6, 8], "skew": 2, "symmetr": 2, "trace": [2, 7], "wish": 2, "simplifi": [2, 3, 9], "now": [2, 3, 4, 6, 7, 8, 9], "over": [2, 6, 7, 8], "next": [2, 3, 4, 5, 6, 8], "decompos": 2, "compon": [2, 8], "realiz": [2, 7], "becaus": [2, 3, 6, 7, 8], "contribut": [2, 4, 5, 7, 8, 9, 10], "part": [2, 7], "vanish": [2, 6], "becom": [2, 8], "ignor": [2, 3], "solut": [2, 8], "actual": [2, 3, 4, 6, 7, 9], "preserv": 2, "symmetri": [2, 7], "easi": [2, 7, 8], "odd": 2, "polynomi": 2, "undo": 2, "our": [2, 4, 5, 6, 7, 8, 9], "suggest": [2, 6, 7], "diverg": [2, 6], "slightli": 2, "fix": [2, 7], "issu": [2, 7, 10], "e": [2, 6, 7, 8], "shortcut": 2, "worth": [2, 8], "note": 2, "least": [2, 7, 8], "cannot": [2, 6], "avoid": [2, 7], "even": [2, 3, 6, 7, 8], "initi": [2, 3, 4, 5, 7, 8], "thought": [2, 7], "easili": [2, 7], "semi": 2, "turn": [2, 3, 7, 8, 9], "gener": [2, 5, 7, 9], "rectangular": [2, 7], "longer": 2, "instead": [2, 7, 8, 9], "wx": 2, "overlin": 2, "y": [2, 6, 7], "column": 2, "miss": [2, 9], "other": [2, 3, 8, 10, 11], "word": [2, 7], "combin": [2, 7], "requir": [2, 5, 8], "unconstrain": 2, "do": [2, 6, 7, 8, 9], "know": [2, 7, 8], "how": [2, 3, 6, 7, 8, 9], "analyt": [2, 9], "result": [2, 6, 7], "ani": [2, 4, 5, 6, 7, 8, 9], "entrywis": 2, "understand": [2, 6, 8, 9, 11], "written": [2, 7, 9], "k": [2, 4, 6, 7], "sigma_i": 2, "u_iv_i": 2, "v_i": 2, "u_i": 2, "neg": [2, 7], "cup": 2, "orthonorm": 2, "lfloor": 2, "rfloor": 2, "admit": [2, 7], "svd": [2, 7, 8], "come": 2, "pair": 2, "conjug": 2, "f": [2, 4, 5, 6, 7], "yield": 2, "intact": 2, "read": [2, 7], "haber": 2, "2016": 2, "youla": 2, "1961": 2, "At": [3, 6, 8], "simplest": [3, 7], "level": [3, 9], "neural": [3, 5, 6, 7, 8, 9, 10, 11], "network": [3, 5, 6, 7, 8, 9, 11], "train": [3, 4, 5, 6, 7, 8, 10], "learning_r": [3, 4, 5, 8], "float": [3, 7, 8], "Of": 3, "cours": [3, 7, 8], "practic": [3, 7, 8, 9], "addit": [3, 7], "trick": 3, "momentum": [3, 7, 8], "detail": [3, 7], "unfortun": 3, "well": [3, 6, 7, 9], "up": [3, 6, 7, 9], "architectur": [3, 7, 8, 10, 11], "what": [3, 6, 7, 8, 9], "befor": [3, 7], "grow": 3, "increas": [3, 6, 8, 9], "width": [3, 4, 5, 6, 7, 9], "number": [3, 4, 5, 6, 7, 8], "neuron": 3, "layer": [3, 6, 7, 9, 11], "depth": [3, 7, 9], "might": [3, 6, 7, 8], "dimens": [3, 7, 8], "residu": [3, 7, 8], "block": [3, 7, 8], "stick": 3, "break": 3, "two": [3, 6, 7, 9, 11], "main": [3, 6, 7, 8, 9, 11], "The": [3, 5, 6, 7, 10, 11], "rate": [3, 5, 6, 7, 8, 9, 11], "drift": 3, "re": [3, 4, 7, 9], "tune": 3, "thing": [3, 7], "expens": [3, 7], "consum": 3, "second": [3, 7, 8, 9, 11], "sometim": [3, 7], "get": [3, 4, 6, 7, 8], "wors": [3, 8], "remain": 3, "stabl": [3, 7, 8], "grew": 3, "hope": [3, 7, 8, 10], "better": [3, 7], "cartoon": 3, "illustr": [3, 8], "typic": 3, "behaviour": [3, 6], "deterior": 3, "new": [3, 6, 7, 8, 11], "develop": [3, 7, 9], "machineri": [3, 9], "larg": [3, 7, 8, 11], "woe": 3, "special": 3, "act": 3, "lead": [3, 7, 9, 10, 11], "remov": [3, 7], "caus": [3, 8], "modula": [3, 4, 5, 6, 8, 9, 11], "automat": [3, 7, 9, 11], "infer": 3, "necessari": [3, 7], "user": 3, "focu": [3, 7], "handl": [3, 5, 7], "properli": [3, 7], "doc": [3, 9], "intend": [3, 9], "explain": [3, 6, 7, 8, 9], "also": [3, 5, 6, 7, 8, 9, 10, 11], "introduc": [3, 8], "api": 3, "you": [3, 6, 7, 8, 9, 10], "don": [3, 6, 7, 8], "care": [3, 7, 9], "about": [3, 6, 7, 8, 9, 10], "manual": [3, 7], "differ": [3, 6, 7, 8, 11], "framework": [3, 7, 8, 10], "pytorch": [3, 7], "jax": [3, 4, 5, 6], "extend": [4, 7, 8], "world": 4, "download": [4, 6], "data": [4, 5, 6], "load_mnist": 4, "load": 4, "dataset": [4, 6], "train_imag": [4, 6], "train_label": [4, 6], "test_imag": [4, 6], "test_label": [4, 6], "print": [4, 5, 6], "shape": [4, 6, 7, 8], "verifi": [4, 9], "imag": [4, 6], "label": [4, 6], "test": [4, 6, 7], "60000": 4, "28": 4, "10000": 4, "plot": [4, 6], "few": [4, 8], "matplotlib": [4, 6], "pyplot": [4, 6], "plt": [4, 6], "creat": [4, 10], "5": [4, 6], "subplot": [4, 6], "fig": [4, 6], "ax": 4, "figsiz": [4, 6], "10": [4, 5, 6, 8], "rang": [4, 5, 6], "imshow": [4, 6], "cmap": [4, 6], "grai": [4, 6], "set_titl": [4, 6], "axi": [4, 6], "off": [4, 6], "tight_layout": [4, 6], "flatten": [4, 7], "input": [4, 5, 6, 7, 8, 11], "encod": 4, "target": [4, 5, 6], "hot": 4, "mini": 4, "batch": [4, 6], "sampler": 4, "numpi": [4, 5, 6], "jnp": [4, 5, 6], "def": [4, 6, 8], "one_hot": [4, 6], "dtype": 4, "float32": 4, "arrai": [4, 5, 6], "none": [4, 6], "arang": [4, 6], "reshap": [4, 6], "convert": [4, 8, 9], "x_train": [4, 6], "y_train": [4, 6], "get_batch": [4, 6], "kei": [4, 5, 6, 10], "batch_siz": [4, 5, 6], "idx": [4, 6], "random": [4, 5, 6, 7, 8, 9], "choic": [4, 6, 7], "readi": [4, 5], "build": [4, 5, 7, 11], "mlp": [4, 5, 6, 8], "4": [4, 5, 6, 7, 8], "atom": [4, 5, 6, 7], "bond": [4, 5, 6], "relu": [4, 5, 6], "input_dim": [4, 5, 6], "output_dim": [4, 5, 6], "256": [4, 5, 6], "jit": [4, 5, 6], "compositemodul": [4, 5], "consist": [4, 5, 7], "non": [4, 5, 6, 7, 8], "smooth": [4, 5, 7, 8, 11], "sensit": [4, 5], "proport": [4, 5, 7, 8], "featur": [4, 5, 9, 11], "supermodul": [4, 5], "1000": [4, 5, 6], "tqdm": [4, 6], "notebook": [4, 6], "error": [4, 5, 6, 7], "squareerror": [4, 5, 6], "128": [4, 5, 6], "prngkei": [4, 5, 6], "progress_bar": 4, "desc": 4, "4f": 4, "output": [4, 5, 6, 7, 8, 11], "activ": [4, 5, 6, 8], "error_grad": [4, 5, 6], "grad": [4, 5, 6, 8], "grad_w": [4, 5, 6], "backward": [4, 5, 6], "d_w": [4, 5, 6], "dualiz": [4, 5, 6, 11], "d_weight": [4, 5, 6], "zip": [4, 5, 6], "set_descript": 4, "And": [4, 5, 6, 7, 8, 9], "predict": [4, 7], "6": [4, 6], "x_test": 4, "test_output": 4, "predicted_label": 4, "argmax": [4, 6], "n_sampl": 4, "displai": 4, "int": [4, 6, 8], "accuraci": [4, 6], "sampl": [4, 5], "correct": [4, 8], "sum": [4, 8], "shown": [4, 6], "overal": [4, 7], "total_correct": 4, "total_sampl": 4, "len": [4, 8], "100": [4, 5, 6], "2f": 4, "97": 4, "52": 4, "loop": [5, 6, 8], "fit": 5, "randomli": [5, 7], "start": [5, 7, 8, 10], "u": [5, 6, 7, 8, 9], "explicitli": [5, 7], "state": [5, 7, 8], "784": 5, "basic": [5, 6, 7, 8, 9], "compos": 5, "them": [5, 7, 8, 11], "tri": 5, "intern": [5, 8], "just": [5, 7, 8, 9], "compil": 5, "allow": [5, 8], "both": [5, 6, 7, 8], "model": [5, 7], "simplic": [5, 7], "modular": [5, 6, 7, 11], "schedul": [5, 7], "lr": [5, 6], "3d": 5, "6f": 5, "976274": 5, "001989": 5, "200": [5, 6], "001537": 5, "300": 5, "001194": 5, "400": 5, "000885": 5, "500": 5, "000627": 5, "600": 5, "000420": 5, "700": 5, "000255": 5, "800": 5, "000134": 5, "900": 5, "000053": 5, "heard": [6, 9], "dure": [6, 7, 8, 9], "wide": [6, 7], "enough": [6, 8], "move": [6, 8], "lee": 6, "et": [6, 7], "al": [6, 7], "2019": [6, 9], "never": 6, "around": [6, 10], "jesu": 6, "2020": [6, 9], "conduct": [6, 7, 8], "intrigu": 6, "support": [6, 7], "narr": 6, "thei": [6, 7, 8], "letter": 6, "find": [6, 7], "still": [6, 7, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "visibl": 6, "long": [6, 7, 8], "investig": [6, 11], "phenomenon": 6, "replic": 6, "dualiti": [6, 10, 11], "base": [6, 7, 8, 9], "exhibit": 6, "qualit": 6, "vanilla": [6, 7], "controvert": 6, "idea": [6, 7, 8, 9, 10, 11], "describ": [6, 7], "paper": [6, 7, 8, 9, 11], "understood": [6, 9], "term": [6, 7, 8], "underscor": 6, "metriz": [6, 7, 9, 10], "numer": [6, 7], "properti": [6, 7, 8, 9, 11], "helper": 6, "contain": [6, 9, 10, 11], "pil": 6, "imagedraw": 6, "imagefont": 6, "create_letter_matrix": 6, "font_nam": 6, "arial": 6, "ttf": 6, "img": 6, "255": 6, "draw": 6, "font": 6, "truetyp": 6, "bbox": 6, "textbbox": 6, "text_width": 6, "text_height": 6, "fill": 6, "resolut": 6, "50": 6, "letter_matric": 6, "side": [6, 7, 10], "enumer": 6, "titl": [6, 10], "cifar": 6, "cifar10": 6, "load_cifar10": 6, "1024": 6, "initial_w": 6, "unmasked_initial_matrix": 6, "masked_initial_matrix": 6, "ax1": 6, "ax2": 6, "vmin": 6, "min": [6, 11], "vmax": 6, "rdbu": 6, "record": 6, "true": 6, "acc": 6, "els": [6, 10], "append": 6, "isfinit": 6, "final_w": 6, "enabl": 6, "disabl": 6, "7": 6, "1001": 6, "lr_list": 6, "fals": 6, "averag": [6, 7], "last": 6, "overlai": 6, "8": 6, "lr_list_dual": 6, "lr_list_nodu": 6, "extract": 6, "final_accs_du": 6, "final_accs_nodu": 6, "final_weights_du": 6, "final_weights_nodu": 6, "small": [6, 8], "main_ax": 6, "gca": 6, "With": [6, 7], "set_xscal": 6, "log": 6, "set_ylim": 6, "add": [6, 8], "lr_disp": 6, "acc_disp": 6, "transdata": 6, "lr_fig": 6, "acc_fig": 6, "transfigur": 6, "invert": 6, "inset": 6, "add_ax": 6, "05": 6, "set_xlabel": 6, "set_ylabel": 6, "after": [6, 7, 8, 9], "effect": [6, 7], "rcparam": 6, "16": 6, "tick_param": 6, "labels": 6, "xaxi": 6, "set_siz": 6, "yaxi": 6, "legend": 6, "loc": 6, "upper": 6, "frameon": 6, "fontsiz": 6, "three": [6, 9], "observ": [6, 7], "reach": [6, 7, 8, 9, 10], "significantli": 6, "higher": 6, "than": [6, 7, 8, 9], "eras": 6, "maximum": 6, "short": [6, 7, 9], "faster": [6, 10], "regim": 6, "unlik": [6, 9], "standard": [6, 7, 8, 9], "evolv": 6, "human": [6, 9], "ey": 6, "ratio": 6, "frobeniu": [6, 7, 9], "srank": 6, "quantiti": [6, 7, 8], "discuss": 6, "entri": [6, 7, 8], "textrm": 6, "mn": 6, "amount": [6, 7, 9], "vari": [6, 9], "depend": [6, 7, 11], "raw": [6, 7], "tend": [6, 8], "high": [6, 7], "between": [6, 7, 8, 9, 11], "made": [6, 9], "place": [6, 10], "sourc": [6, 8], "map": [6, 7, 8, 10], "check": [6, 8, 10], "inflat": 6, "equal": [6, 8], "9": 6, "stable_rank_grad": 6, "stable_rank_dualized_grad": 6, "linalg": [6, 8], "ord": 6, "fro": 6, "32": 6, "64": 6, "512": 6, "2048": 6, "4096": 6, "8192": 6, "o": 6, "axvlin": 6, "color": 6, "linestyl": 6, "axhlin": 6, "xscale": 6, "yscale": 6, "xlabel": 6, "hidden": [6, 11], "ylabel": 6, "As": [6, 8], "meanwhil": 6, "until": 6, "plateau": 6, "expect": [6, 8], "cap": 6, "beyond": [6, 8], "itself": [6, 7], "when": [6, 7, 8, 9, 11], "hardli": 6, "substanti": [6, 9], "becam": 6, "thank": 6, "tweet": 6, "nora": 6, "belros": 6, "tongzhou": 6, "wang": 6, "ran": 6, "question": [6, 8], "feel": [7, 11], "free": [7, 8], "github": [7, 10], "ll": 7, "post": 7, "answer": [7, 8], "common": 7, "mental": 7, "jump": [7, 10], "list": [7, 8], "mathbf": [7, 9], "_1": 7, "dot": 7, "_l": 7, "_k": 7, "sens": 7, "th": 7, "being": 7, "nabla_": 7, "w_k": 7, "meaningfulli": 7, "contrast": 7, "approach": [7, 8, 11], "theori": [7, 9, 10], "whole": 7, "big": 7, "correspond": [7, 8, 10], "thu": 7, "lose": 7, "structur": [7, 9, 11], "why": [7, 8, 9], "adam": [7, 8], "beat": 7, "sgd": 7, "challeng": 7, "certainli": 7, "languag": 7, "known": 7, "here": [7, 8, 10, 11], "aim": 7, "mechanist": 7, "explan": 7, "should": [7, 8], "rel": 7, "across": [7, 8, 9], "major": [7, 9, 11], "rebal": 7, "give": 7, "concret": 7, "Then": [7, 10], "global": 7, "toi": 7, "w_": 7, "w_1": 7, "_0": 7, "depress": 7, "factor": [7, 8], "includ": [7, 8], "limit": [7, 8, 9], "advoc": 7, "inclus": 7, "nonlinear": 7, "essenti": [7, 9], "_3": 7, "kill": 7, "comparison": 7, "stuck": 7, "sever": 7, "middl": [7, 8], "individu": [7, 8], "form": [7, 8], "rebalanc": 7, "transfer": [7, 9], "scale": 7, "By": [7, 8], "definit": 7, "mathsf": 7, "delta": [7, 9, 11], "behav": [7, 8], "gpt": [7, 8], "independ": 7, "littl": [7, 8, 9], "bit": [7, 9], "lipschitz": [7, 11], "inequ": 7, "hold": [7, 8], "tightli": 7, "approxim": 7, "approx": 7, "fulli": [7, 8], "control": [7, 8, 9, 11], "statement": [7, 8], "recurs": [7, 8, 11], "submodul": 7, "desir": 7, "compound": 7, "gut": 7, "found": [7, 8], "v": [7, 8], "b": [7, 9], "insid": 7, "friendli": 7, "dimension": [7, 8], "symbol": [7, 11], "length": [7, 8, 9], "ell_2": 7, "cauchi": 7, "schwarz": 7, "tight": 7, "opposit": 7, "configur": 7, "higer": 7, "order": [7, 8, 9], "relev": 7, "li": 7, "sub": [7, 8], "sai": [7, 8], "quit": [7, 8, 9], "slack": 7, "orient": 7, "central": [7, 10], "tenet": [7, 8], "suffici": 7, "warm": [7, 8], "fall": [7, 8], "type": [7, 8, 11], "mention": 7, "variou": 7, "outlin": 7, "captur": 7, "whether": 7, "govern": 7, "expon": 7, "coupl": 7, "bear": 7, "empir": [7, 9], "valuabl": 7, "futur": [7, 9], "uniqu": 7, "freedom": 7, "your": [7, 8], "said": 7, "agre": 7, "eas": 7, "commun": 7, "lora": 7, "\u03bcp": 7, "afficionado": 7, "d": 7, "fan": [7, 9], "propto": [7, 9], "restrict": 7, "homogeneu": 7, "ba": 7, "noth": 7, "exactli": [7, 8], "dynam": 7, "repres": 7, "scheme": 7, "represent": 7, "low": [7, 8], "format": 7, "charli": 7, "blake": 7, "exploit": 7, "parametr": 7, "summari": 7, "demonstr": 7, "sensibl": 7, "default": 7, "situat": [7, 8], "specif": 7, "modifi": 7, "rule": [7, 11], "advantag": 7, "design": [7, 8], "relationship": 7, "embed": 7, "arbitrari": 7, "composit": [7, 9], "concaten": 7, "net": [7, 8], "program": 7, "scienc": 7, "releas": 7, "almost": 7, "year": [7, 9, 10], "incarn": 7, "ground": 7, "elementari": 7, "math": [7, 8, 9], "estim": 7, "ingredi": 7, "bound": [7, 11], "track": [7, 11], "emploi": 7, "probabilist": 7, "analys": 7, "asymptot": 7, "unifi": [7, 9], "thread": 7, "seri": 7, "infinit": [7, 8, 9], "encumb": 7, "signific": [7, 9], "mathemat": [7, 8, 9], "overhead": 7, "often": [7, 8], "confront": 7, "thorni": 7, "commut": 7, "deal": 7, "directli": [7, 8], "finit": 7, "worri": 7, "lost": 7, "talk": 7, "built": [7, 10], "graph": 7, "priori": 7, "per": 7, "prior": 7, "hairi": 7, "procedur": [7, 11], "henc": 7, "later": 7, "shift": [7, 9], "easier": [7, 9], "alreadi": [7, 8, 9], "impos": 7, "furthermor": 7, "done": [7, 8], "hand": [7, 10], "tabl": 7, "versu": 7, "skinni": 7, "ultim": 7, "inspir": [7, 8, 9, 10], "followup": 7, "clean": 7, "sound": 7, "toward": 7, "extens": 7, "ell_": 7, "rm": 7, "therebi": 7, "induc": [7, 9], "view": [7, 9], "stabil": [7, 9, 11], "infin": 7, "sort": 7, "consider": 7, "agd": 7, "analysi": [7, 11], "focus": [7, 9], "minim": [7, 9, 11], "style": [7, 8], "connect": 7, "surpris": 7, "aspect": 7, "wa": [7, 9], "decai": [7, 8], "hyperparamet": [7, 8, 9, 11], "slower": [7, 9], "convent": [7, 8], "setup": 7, "autom": [7, 8], "came": 7, "overli": 7, "pessimist": 7, "experi": [7, 8], "opt": 7, "rather": 7, "jeremi": [7, 9, 10, 11], "analogu": [7, 8], "involv": [7, 8, 9], "peopl": [7, 9], "konstantin": 7, "mishchenko": 7, "aaron": 7, "defazio": 7, "prodigi": 7, "great": 7, "shampoo": 7, "myself": [7, 11], "whose": 7, "further": [7, 9, 10], "mathrm": [7, 8], "righthand": 7, "shorthand": 7, "decomposit": 7, "sigma": [7, 8], "minimis": 7, "That": 7, "squeez": 7, "most": [7, 8, 9], "juic": 7, "somewhat": 7, "classic": 7, "appear": 7, "2015": [7, 9], "stochast": 7, "tim": [7, 11], "me": 7, "did": 7, "laker": [7, 11], "newhous": [7, 11], "who": 7, "talent": 7, "undergrad": [7, 9], "mit": [7, 9], "stop": 7, "cool": 7, "had": 7, "recent": [7, 9], "anoth": [7, 9], "tfrac": 7, "precondition": 7, "accumul": 7, "drop": 7, "perspect": [7, 9], "interpret": 7, "oppos": 7, "predomin": 7, "coolest": 7, "someth": [7, 8, 10], "rohan": 7, "anil": 7, "slide": 7, "raphson": 7, "topic": [7, 9, 11], "root": 7, "slobodan": 7, "laki\u0107": 7, "implement": [7, 9], "gist": 7, "speedup": 7, "willing": 7, "toler": 7, "extrem": 7, "shampoolinear": 7, "replac": [7, 8], "zeroth": 7, "power": 7, "jack": 7, "gallagh": 7, "modulax": 7, "p": 7, "q": 7, "separ": 7, "satur": 7, "subvector": 7, "intial": 7, "No": 7, "gaussian": [7, 8], "wise": 7, "varianc": [7, 8], "difficult": [7, 8], "benign": 7, "subtl": [7, 8], "share": 7, "Not": 7, "present": [7, 9], "although": [7, 9], "savant": 7, "field": 7, "bring": 7, "advanc": [7, 9], "tool": 7, "theoret": 7, "physic": 7, "my": [7, 9], "usual": 7, "simpler": [7, 8, 9], "strongli": 7, "stage": 7, "reson": 7, "rahimi": 7, "recht": 7, "georg": 7, "dahl": 7, "healthi": 7, "dose": 7, "skeptic": 7, "literatur": 7, "huh": [8, 11], "too": [8, 10], "boil": 8, "principl": [8, 9], "algebra": 8, "bad": 8, "unlearn": 8, "concept": 8, "taught": 8, "lectur": 8, "101": 8, "compar": 8, "deviat": 8, "class": [8, 9], "__init__": 8, "self": 8, "fan_out": 8, "fan_in": 8, "torch": 8, "randn": 8, "forward": 8, "matmul": 8, "reduct": 8, "smaller": 8, "happen": [8, 9], "classifi": 8, "larger": 8, "null": 8, "huge": 8, "lie": 8, "nullspac": 8, "pick": 8, "align": 8, "chose": 8, "far": 8, "hindsight": 8, "blow": 8, "assumpt": [8, 9], "fine": 8, "quickli": 8, "nice": 8, "bonu": 8, "switch": 8, "init": 8, "trivial": 8, "distil": 8, "largest": 8, "carefulli": 8, "expand": 8, "row": 8, "diagon": 8, "preced": 8, "head": 8, "tail": 8, "backpropag": 8, "rest": 8, "interv": 8, "equival": [8, 9], "achiev": 8, "tell": 8, "intuit": 8, "spit": [8, 9], "clever": 8, "reparameter": 8, "reparameterizedlinear": 8, "empti": 8, "nn": 8, "orthogonal_": 8, "spectral_norm": 8, "option": 8, "frobenius_norm": 8, "look": 8, "resnet": 8, "residue_list": 8, "block_multipli": 8, "ad": 8, "ensur": 8, "third": 8, "total": 8, "similar": 8, "though": 8, "prevent": 8, "link": 8, "analogi": 8, "plai": 8, "role": 8, "safe": 8, "accord": 8, "convention": 8, "assum": 8, "uncorrel": 8, "spell": 8, "clearli": 8, "wisdom": 8, "logic": 8, "associ": 8, "scalabl": [8, 9, 10, 11], "anyth": 8, "object": 8, "vein": 8, "obviat": 8, "histori": 8, "behind": [8, 10], "applic": [8, 11], "outer": 8, "propos": [8, 9], "mani": [8, 9, 11], "best": 8, "knowledg": 8, "twist": 9, "particip": 9, "subfield": 9, "purpos": 9, "reader": 9, "llm": 9, "histor": 9, "potenti": 9, "bias": 9, "hi": 9, "piec": 9, "relat": 9, "love": 9, "either": 9, "pull": [9, 10], "request": [9, 10], "email": [9, 10], "internship": 9, "nvidia": 9, "instabl": 9, "biggan": 9, "arash": 9, "vahdat": 9, "ming": 9, "yu": 9, "liu": [9, 11], "perturb": 9, "learnt": 9, "senthil": 9, "todadri": 9, "graduat": 9, "quantum": 9, "mechan": 9, "took": 9, "continu": 9, "caltech": 9, "phd": 9, "advisor": 9, "yisong": 9, "yue": 9, "bernstein": [9, 10, 11], "neurip": [9, 11], "core": 9, "emphasis": 9, "version": 9, "account": 9, "anticip": [9, 10], "unlock": 9, "workflow": 9, "deeper": 9, "complex": 9, "minut": 9, "youtub": 9, "video": 9, "lai": 9, "wrote": 9, "arxiv": [9, 11], "2002": 9, "03432": 9, "greg": 9, "yang": [9, 11], "edward": 9, "hu": 9, "j": 9, "icml": 9, "2021": 9, "argument": 9, "parameteris": 9, "arguabl": 9, "innov": 9, "sweep": 9, "earlier": 9, "were": 9, "inaccur": 9, "fromag": 9, "lar": 9, "team": 9, "jami": 9, "simon": 9, "reconcil": 9, "jame": 9, "2023": 9, "streamlin": 9, "singl": 9, "formula": 9, "mathtt": 9, "_out": 9, "_in": 9, "formul": 9, "inspect": 9, "anecdot": 9, "hug": 9, "face": 9, "nanotron": 9, "line": 9, "brain": 9, "reliabl": 9, "shouldn": 9, "artifici": 9, "system": [9, 10], "organ": 9, "pursu": 9, "agenda": 9, "chri": 9, "mingard": 9, "kevin": 9, "huang": 9, "navid": 9, "azizan": 9, "surprisingli": 9, "techniqu": 9, "abandon": 9, "intrins": 10, "benefit": 10, "current": 10, "process": 10, "overhaul": 10, "code": 10, "unclear": 10, "faq": 10, "everyon": 10, "arrow": 10, "panel": 10, "origin": 10, "publish": 10, "anywher": 10, "bibtex": 10, "misc": 10, "author": [10, 11], "url": 10, "http": 10, "2025": 10, "academ": 11, "assign": 11, "avail": 11, "minyoung": 11, "hyojin": 11, "bahng": 11, "phillip": 11, "isola": 11, "2024": 11, "subject": 11, "langl": 11, "nabla": 11, "rangl": 11, "due": 11, "leverag": 11, "precondit": 11, "univers": 11, "old": 11, "anthologi": 11, "muon": 11, "margin": 11, "pac": 11, "bayesian": 11}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"hyperspher": 0, "steepest": [0, 2], "descent": [0, 2], "The": [0, 2, 8, 9], "structur": [0, 2], "tangent": [0, 2], "space": [0, 2], "direct": [0, 2], "find": [0, 2], "retract": [0, 2], "map": [0, 1, 2], "manifold": [1, 2], "dualiti": 1, "orthogon": 2, "non": 2, "riemannian": 2, "method": 2, "open": 2, "problem": 2, "extend": 2, "stiefel": 2, "bad": 3, "scale": [3, 8, 9], "hello": [4, 5], "mnist": 4, "world": 5, "weight": 6, "erasur": 6, "setup": 6, "creat": 6, "watermark": 6, "initi": 6, "run": 6, "experi": 6, "interpret": 6, "via": 6, "stabl": 6, "rank": 6, "conclus": 6, "acknowledg": 6, "frequent": 7, "ask": 7, "question": 7, "conceptu": 7, "other": 7, "notion": 7, "align": 7, "matter": 7, "precis": 7, "relat": 7, "work": 7, "modula": [7, 10], "packag": 7, "research": 7, "philosophi": 7, "golden": 8, "rule": 8, "linear": [8, 15], "layer": 8, "three": 8, "fix": 8, "width": 8, "depth": 8, "kei": 8, "queri": 8, "dot": 8, "product": 8, "wrap": 8, "up": 8, "scienc": 9, "warn": [9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21], "pre": 9, "histori": 9, "\u03bcp": 9, "enter": 9, "chat": 9, "truth": 9, "reconcili": 9, "autom": 9, "train": 9, "welcom": 10, "doc": 10, "purpos": 10, "navig": 10, "cite": 10, "read": 11, "list": 11, "optim": 11, "gener": 11, "conv2d": 12, "embed": 13, "atom": 14, "modul": [14, 16, 19, 20], "bond": 16, "nonlinear": 17, "gpt": 18, "compound": 19, "vector": 21}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Hypersphere": [[0, "hypersphere"]], "Steepest descent on the hypersphere": [[0, "steepest-descent-on-the-hypersphere"]], "The structure of the tangent space": [[0, "the-structure-of-the-tangent-space"], [2, "the-structure-of-the-tangent-space"]], "Steepest direction in the tangent space": [[0, "steepest-direction-in-the-tangent-space"], [2, "steepest-direction-in-the-tangent-space"]], "Finding the retraction map": [[0, "finding-the-retraction-map"], [2, "finding-the-retraction-map"]], "Manifold duality maps": [[1, "manifold-duality-maps"]], "Orthogonal manifold": [[2, "orthogonal-manifold"]], "Steepest descent on the orthogonal manifold": [[2, "steepest-descent-on-the-orthogonal-manifold"]], "Non-Riemannian manifold methods": [[2, "non-riemannian-manifold-methods"]], "Open problem: Extending to the Stiefel Manifold": [[2, "open-problem-extending-to-the-stiefel-manifold"]], "Bad scaling": [[3, "bad-scaling"]], "Hello, MNIST!": [[4, "Hello,-MNIST!"]], "Hello, World!": [[5, "Hello,-World!"]], "Weight erasure": [[6, "Weight-erasure"]], "Setup: Creating a watermark": [[6, "Setup:-Creating-a-watermark"]], "Watermarking the initial weights": [[6, "Watermarking-the-initial-weights"]], "Running the experiment": [[6, "Running-the-experiment"]], "Interpretation via the stable rank": [[6, "Interpretation-via-the-stable-rank"]], "Conclusion": [[6, "Conclusion"]], "Acknowledgements": [[6, "Acknowledgements"]], "Frequently asked questions": [[7, "frequently-asked-questions"]], "Conceptual questions": [[7, "conceptual-questions"]], "Other notions of alignment": [[7, null]], "Matters of precision": [[7, null]], "Related work": [[7, "related-work"]], "Modula package": [[7, "modula-package"]], "Research philosophy": [[7, "research-philosophy"]], "Golden rules for scaling": [[8, "golden-rules-for-scaling"]], "The linear layer": [[8, "the-linear-layer"]], "Three golden rules": [[8, "three-golden-rules"]], "Fixing width scaling": [[8, "fixing-width-scaling"]], "Fixing depth scaling": [[8, "fixing-depth-scaling"]], "Fixing key-query dot product scaling": [[8, "fixing-key-query-dot-product-scaling"]], "Wrapping up": [[8, "wrapping-up"]], "The science of scale": [[9, "the-science-of-scale"]], "Warning": [[9, null], [12, null], [13, null], [14, null], [15, null], [16, null], [17, null], [18, null], [19, null], [20, null], [21, null]], "Pre-history": [[9, "pre-history"]], "\u03bcP enters the chat": [[9, "p-enters-the-chat"]], "Truth and reconciliation": [[9, "truth-and-reconciliation"]], "Automation of training": [[9, "automation-of-training"]], "Welcome to the Modula docs!": [[10, "welcome-to-the-modula-docs"]], "Purpose of the docs": [[10, "purpose-of-the-docs"]], "Navigating the docs": [[10, "navigating-the-docs"]], "Citing the docs": [[10, "citing-the-docs"]], "Reading list": [[11, "reading-list"]], "Optimization": [[11, "optimization"]], "Generalization": [[11, "generalization"]], "Conv2d": [[12, "conv2d"]], "Embedding": [[13, "embedding"]], "Atomic modules": [[14, "atomic-modules"]], "Linear": [[15, "linear"]], "Bond modules": [[16, "bond-modules"]], "Nonlinearities": [[17, "nonlinearities"]], "GPT": [[18, "gpt"]], "Compound modules": [[19, "compound-modules"]], "Modules": [[20, "modules"]], "Vectors": [[21, "vectors"]]}, "indexentries": {}})